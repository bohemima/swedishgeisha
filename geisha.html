<head>
  <title>geisha</title>
  <script type="text/javascript" src="http://timeago.yarp.com/jquery.timeago.js"></script>
  <script type="text/javascript">

    jQuery.timeago.settings.allowFuture = true;

    $(function () {
      setInterval(function () {
        $('time:not([data-time="time"])').attr('data-time', 'time').timeago();
      }, 100);
    });

  </script>
  <link href='http://fonts.googleapis.com/css?family=Alex+Brush' rel='stylesheet' type='text/css'>
</head>

<body>
  {{> main}}
</body>

<template name="main">
  <div id="wrapper">
    <h1>Welcome to Swedish Geisha</h1>
    {{#if logged_in}}
      {{> room}}
    {{else}}
    <form id="loginForm">
      <label>
        Name: <input type="text" id="user-name" />
      </label>
      <input type="submit" value="Login" />
    </form>
    {{/if}}
  </div>
</template>

<template name="room">
  <div class="roomScreen">
    <ul id="messages">
      {{#each messages}}
        <li>
          <span>{{author}} :</span> {{text}}
          <time class="timestamp" datetime="{{timestamp}}"></time>
        </li>
      {{/each}}
    </ul>
    <form>
      <label for="msg">Message: </label>
      <input id="msg" />
      <button type="submit">&rArr; Send</button>
    </form>
  </div>
</template>
